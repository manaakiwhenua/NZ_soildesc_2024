# Landscape

```{r}
library(dplyr)
library(tibble)
library(gt)
library(gtExtras)
```

-   setup - going big to small
-   purpose - interpretive context
-   note: discuss when a DEM/terrain derivatives can and can't be used post-field

## Regional landscape

The regional landscape around a soil observation comprises a distinct geomorphological pattern with repeating elements. The scale of observation varies but commonly extends from a few hundred to a few thousand meters [@heck2017]. New Zealand currently lacks a national classification scheme focusing on this concept, although the 'landform trees' in S-Map are a step in that direction (REF??).

In the absence of such a system, one can describe a regional landscape in terms of a short list of parameters: relief, characteristic slope(s), surface drainage pattern,

-   scale: 100s-1000s of meters (ref Ontario guide for this idea)
-   don't have a nationally accepted ecozone system yet
-   do have LUC (brief discussion)
-   do have SMap landform trees (brief discussion)

### Relief

Relief is the degree of separation between high and low points in a landscape. As described in [@nationalcommitteeonsoilandterrain2009, pp. 45], relief can be visualised by picturing two surfaces roughly parallel to the land surface - one passing through local crests and one through local depressions. The median vertical distance between the two surfaces is the relief.

[add a diagram here]{style="background-color:lightgreen"}

Relief is usually best determined from a DEM, but can be estimated in the field. Record in whole meters if estimating.

### Characteristic slope

The characteristic slope is the most common range of slopes within a regional landscape. These are often controlled by local geology. This measure is often expressed as the modal value of local slope classes, but can also be expressed as a median value in degrees, plus or minus an appropriate range (e.g. 1 standard deviation to capture 68% of slopes in a landscape).

Characteristic slope is usually best determined from a DEM-derived slope dataset, but can be estimated in the field. Record in the field as a \[low, high\] range of degrees.

### Drainage pattern

### Landscape description

-   shortcut terms, noting that they don't form a conceptual tesselation
-   longform descriptions

------------------------------------------------------------------------

## Local landform

-   scale: 1-10s of meters around site
-   starting with simple measurements and moving to more interpretive ones

### Slope

Slope is the inclination of the land surface relative to the horizontal plane. Slope steepness affects many soil processes, notably water run-off and infiltration behaviour.

Direct measurements of slope should be taken at the landform scale, over a minimum distance of 20 meters. Stand 10 m up-slope from the soil site and measure downhill. Record in units of degrees, with a maximum precision of 0.1. Precision needs will vary with slope and survey purpose; whole number degrees are fine on any slope over about 5 degrees, but finer gradations can be useful for defining low-relief landforms.

Slope classes may be applied to the recorded data; some options are presented in @sec-slopeclass.

-   TODO Note about getting slope from DEM

::: callout-note
## Extracting slope from DEMs

Slope data for a site can be extracted from a DEM, provided some conditions are met:

-   Cell size should be less than 10 m; larger cells systematically underestimate local slope
-   DEM source should ideally be of type [**D**]{style="color: red"} for acceptable accuracy (see @sec-loc-abs-elev)
-   Extract the median slope within a 20 m radius, not the single value directly under the recorded point
-   Review and, if necessary, adjust slopes extracted from sites described on exposures. These may be overestimates (e.g. where a track cuts into a slope, the values upslope behind the site would better represent the landform). Similarly, sites close to landform or landscape boundaries may also need review.
:::

### Aspect

Aspect is the direction a slope faces. Slope aspect helps determine exposure to sun, rain and prevailing winds, and so influences the biome growing in a particular soil. In some environments it also helps determine how much new material is received by aeolian or fluvial deposition.

Aspect should be measured at the same time and over the same transect as slope. Record aspect in whole degrees clockwise from North, using the range \[0-359\] (360 == 0). Use NA for flat ground. Use NR if unable to record.

For rapid assessment, record compass bearing on an 8 or 16 point scale (e.g. NE, SSE).

-   TODO Note: defining 'flat' in soil survey.
-   TODO Note: map vs magnetic north, and consequences for field-measured vs DEM-derived aspect measurements

### Landform element morphology

The following is adapted from [@nationalcommitteeonsoilandterrain2009, pp. 19-26].

Landform elements can be assigned to a morphological type - one of a series of raw shapes - at the scale of observation. These are:

```{r}
#| label: tbl-hr-elemmorph
#| tbl-cap: "Landform Element Morphologies"

dat_hr_elemmorph <-
  tribble(~Code, ~Name,
          'CR', 'Crest',
          'RI', 'Ridge',
          'SL', 'Slope',
          'FL', 'Flat',
          'DO', 'Open depression',
          'DC', 'Closed depression')

# TODO add some little graphics in a third column

tbl_hr_elemmorph <- gt(dat_hr_elemmorph) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color = 'red', weight = 'bold')),
            locations = cells_body(columns = 1)) |>
  cols_width(Code ~pct(20))

tbl_hr_elemmorph

```

Note that these are paired mirror images, e.g. a closed depression is the opposite of a crest. Each morphological type extends to a break of slope or point of 0-curvature.

Slopes can be further refined by including additional information appended about their relationship to their neighbouring elements. Up and down slope, four options are available.

```{r}
#| label: tbl-hr-slopeinc
#| tbl-cap: "Slope element relative inclination"

dat_hr_slopeinc <-
  tribble(~Code, ~Name, ~Description,
          'X', 'Waxing', 'element upslope is gentler, element downslope is steeper.',
          'N', 'Waning', 'element upslope is steeper, element downslope is gentler.',
          'A', 'Maximal', 'element upslope is gentler, element downslope is gentler.',
          'I', 'Minimal', 'element upslope is steeper, element downslope is steeper.')

tbl_hr_slopeinc <- gt(dat_hr_slopeinc) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color = 'red', weight = 'bold')),
            locations = cells_body(columns = 1)) |>
  cols_width(Code ~pct(20), Name ~pct(20))

tbl_hr_slopeinc

```

Two more are available across the slope.

```{r}
#| label: tbl-hr-slopeenc
#| tbl-cap: "Slope element relative enclosure"

# I'm stepping into new territory here D:

dat_hr_slopeenc <-
  tribble(~Code, ~Name, ~Description,
          'L', 'Enclosed', 'Adjacent slope elements face towards each other',
          'E', 'Exposed', 'Adjacent slope elements face away from each other')

tbl_hr_slopeenc <- gt(dat_hr_slopeenc) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color = 'red', weight = 'bold')),
            locations = cells_body(columns = 1)) |>
  cols_width(Code ~pct(20), Name ~pct(20))

tbl_hr_slopeenc

```

This combination of properties gives rise to more complex shapes. For example, an open hollow could be described as an enclosed maximal slope ([**L-A-SL**]{style="color: red"}). A shoulder would be an exposed waxing slope ([**E-X-SL**]{style="color: red"}). Adding further information about slope and aspect, once classified, can define a complete element. For instance a gently sloping, northeast facing fan - GE NE E N SL.

-   TODO add graphics

### Slope length

The length of a slope element is measured downslope, and provides information on...

-   mention RUSLE connection

### Mesoscale topographic index

The Mesoscale Topographic Index (MTI) [@hurst2007, p. 32] is a simple measure of how sheltered or exposed a location is within a landscape. To measure in-field, use a compass and clinometer to measure angle to the horizon at the 8 cardinal compass bearings. Record positive values if looking up and negative when looking down. The index formula is then `(average)/-1`, with high values signifying a sheltered area and low values signifying exposure.

::: callout-tip
The closest automated equivalents of the MTI appear to be the 'Morphometric Protection Index' (MPI) as implemented in SAGA-GIS [@yokoyama2002; @conrad2015], and the 'intensity' output of the 'Geomorphons' module as implemented in GRASS-GIS [@jasiewicz2013; @grassdevelopmentteam2023]. In the case of geomorphon intensity, the output also reports the mean relative elevation in meters of the 8 defining points rather than their average angles above or below the central point.
:::

::: callout-warning
Field and computer-based measurement of MTI may differ slightly. The in-field version measures against magnetic north rather than 'map north', which will vary with spatial data projection.
:::

### Active geomorphic agents

-   eroded vs aggraded then types

### Landform description

-   shortcut terms, noting that they don't form a conceptual tesselation
-   longform descriptions
