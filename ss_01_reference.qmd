---
output: html_document
editor_options: 
  chunk_output_type: console
---

# Reference data {#sec-ss-ref}

```{r}
library(dplyr)
library(tibble)
library(gt)
library(gtExtras)
```

Reference data is metadata that clearly identifies a soil profile description. This enables linking the description to other profiles, samples, analytical results and photographs. Reference data includes:

-   an identifier
-   who completed the description
-   when and where it was located
-   why the description was needed
-   how the location was chosen

These are discussed in turn below.

## Profile description identifiers {#sec-ss-ref-id}

Assign each profile description a job or project identifier followed by a sequential number, e.g. '[ABC_001]{.ceg}'.

::: {#nte-uuid .callout-note collapse="true" appearance="minimal" title="Unique identifiers"}

There are many ways to build profile identifiers. The recommendation above is a compromise between robustness and simplicity that can at least guarantee unique identifiers within an active working group, e.g. a small business.

Well-designed databases use truly unique identifiers for every piece of data they hold. Under contemporary best practice, these are usually 'UUIDs', 128-bit hexadecimal codes (see [RFC 9562]{.todo}). While technically robust, these are difficult to work with day-to-day, and most workers will find themselves preferring to interact with simpler identifiers. In a soil profile database, these should be implemented as UUID aliases. End users should primarily interact with the aliases, and the UUIDs should remain hidden.
:::

::: {#nte-teamsites .callout-note collapse="true" appearance="minimal" title="Working in teams"}
Semi-unique identifiers require active management when working with multiple field teams operating in parallel. This avoids the risk of two sites being given the same ID on the same day. Each team should be assigned a 'block' of identifiers to work through, large enough to cover the intended number of profile descriptions.
:::

::: {#nte-sitetags .callout-note collapse="true" appearance="minimal" title="Other profile groupings"}
It may be desirable to be able to group profile descriptions in more complex ways. Examples of these might include

-   descriptions belonging to a transect or plot
-   descriptions representing a chrono-, climo- or topo-sequence

A tagging system can be useful in these cases. Otherwise, consider whether additional custom metadata fields should be implemented.
:::

## Authors {#sec-ss-ref-auth}

Each profile description must have a single responsible author. Record their name. Additional participants may also be noted.

Use a short unique identifier for each officer, for example [SMITJ]{.ceg} for John Smith. These may be linked to a more complex user management system.

::: {#cau-priv .callout-caution collapse="true" appearance="minimal" title="Data privacy"} 

New Zealand data privacy laws are strict. Personally identifying information must be stored securely and not distributed without a good reason. Personal details such as names may not be publishable without explicit consent. Data storage solutions must respect these requirements.

:::

## Location {#sec-ss-ref-loc}

Record location coordinates as eastings and northings in New Zealand Transverse Mercator, e.g [1586090E, 5405720N]{.ceg}.

This is the bare minimum requirement for site location; see @sec-ss-loc for a more detailed discussion.

## Date {#sec-ss-ref-dt}

Record the date of observation using the ISO 8601 standard, [YYYY-MM-DD]{.ceg} [@internationalorganizationforstandardization]

## Site purpose {#sec-ss-ref-why}

The original task for which a site was observed can affect what data is recorded and is relevant to data re-use decisions.

Record the reason for sampling using the schema in @tbl-ss-reason. This parameter does not need to be recorded in the field.

```{r}
#| label: tbl-ss-reason
#| tbl-cap: "Site purpose"

dat_ss_reason <-
  tribble(~Code, ~Name,
          'E', 'Mapping exploration',
          'V', 'Mapping validation',
          'R', 'Research',
          'M', 'Monitoring',
          'T', 'Reference',
          'D', 'Development')

tbl_ss_reason <- gt(dat_ss_reason) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color = 'red', weight = 'bold')),
            locations = cells_body(columns = 1)) |>
  cols_width(Code ~pct(20))

tbl_ss_reason
```

::: {#nte-ss-reason .callout-note collapse="true" appearance="minimal" title="About these categories"}

[D]{.ceg} sites are often carried out as part of planning for a resource consent. The soil they describe may be removed or sealed after observation, limiting data re-use potential. [M]{.ceg} monitoring sites imply repeated, regular re-sampling activity and perhaps an expectation of minimal major disturbance between visits.

[V]{.ceg} validation sites may be low-detail, as they are intended to confirm or deny a prediction. [T]{.ceg} reference sites (T for ‘type’) may be expected to have high morphological detail and a lot of accompanying analytical data, as they represent ‘ideal’ profiles for particular soil classes.

[E]{.ceg} mapping exploration sites may have biased, opportunistic sample locations and moderate location precision, while [R]{.ceg} sites are more likely to have been predetermined by a model and located with high precision.
:::

## Site selection method {#sec-ss-ref-sampstrat}

Spatial sampling strategies vary in their statistical properties. Soil data is stored for long periods and is often re-used for multiple projects; specific re-uses may not be appropriate.

Record the spatial sampling strategy used using the schema in @tbl-ss-sampstrat. This parameter does not usually need to be recorded in the field.

```{r}
#| label: tbl-ss-sampstrat
#| tbl-cap: "Spatial sampling strategies"

dat_ss_sampstrat <-
  tribble(~Code, ~Name,
          'A', 'Arbitrary/opportunistic',
          'D', 'Data-driven',
          'M', 'Model-based',
          'R', 'Random',
          'T', 'Transect',
          'G', 'Grid')

tbl_ss_sampstrat <- gt(dat_ss_sampstrat) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color = 'red', weight = 'bold')),
            locations = cells_body(columns = 1)) |>
  cols_width(Code ~pct(20))

tbl_ss_sampstrat
```

::: {#nte-ss-sampstrat .callout-note collapse="true" appearance="minimal" title="About these categories"}

The difference between data-driven [D]{.ceg} and model-based [M]{.ceg} centres around replicability. Data-driven sites are nominated using a loose set of rules or principles (e.g. “visit the major landforms on this farm but don’t go too far off the tracks”) and may be subject to minor changes once the worker is on-ground. Model-based site choices formalise this process with reference to specific input datasets, and the worker is committed to sample at the exact point chosen. Model-based methods may include ‘backup points’ for where an intended location cannot be physically accessed, but these are also pre-determined. Importantly, model-based choices can be regenerated from the same inputs.

Arbitrary [A]{.ceg} points are not pre-determined at all; rather, they are chosen after the worker is on site, in response to direct observation of on-ground conditions. These are often practical and time-efficient but are also likely to over-sample the more easily accessible and/or interesting parts of the landscape, to the detriment of overall representativeness.

Random, transect and grid sampling [R]{.ceg}, [T]{.ceg}, [G]{.ceg} effectively ignore environmental parameters. This is useful when the spatial distribution of a parameter of interest is unknown or poorly understood.

Some of these methods can be combined - for example, data-driven transect choices with randomised locations along each. In such cases, the 'last choice' should be recorded - in this case, [R]{.ceg}. The details of the full sampling strategy should be discussed in project metadata.
:::
