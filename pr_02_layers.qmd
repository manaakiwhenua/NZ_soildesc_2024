# Defining soil horizons {#sec-hor}

```{r}
library(dplyr)
library(tibble)
library(ggplot2)
library(gt)
```

A soil horizon is a distinct layer observable within a soil profile. Horizons are distinguished by differences in texture, stoniness, structure, colour, consistence or other soil properties as described in the following sections. Delineated horizons should ideally represent depth intervals over which important soil attributes change minimally. Conversely, the horizon boundaries should represent depth intervals over which there is a relatively high rate of change of important soil properties.

Not all important soil properties change from one horizon to the next or at the same rate with depth. In some instances confident interpretation of the suitability of a soil for a particular end use may depend on the rate of change of a single property at a horizon boundary. For this reason the basis for separating the horizon may need to be explicitly stated, not just the traditional generalised estimate of the amount of overall change.

::: {#nte-chor .callout-note appearance="minimal" collapse="true" title="Complex horizons"}
Some horizons have an internally complex structure that nonetheless clearly represents a distinct zone within the soil profile. Examples of such may include:

-   Partially weathered layers comprising a mix of soil, saprolite and rock materials
-   Layers comprising a complex depositional environment, e.g.
    -   A sequence of very thin deposits, sometimes in a repeating pattern of texture contrasts (lamellae or lamina)
    -   Volcanic ash products of contrasting texture, weathered in place (soft blocks or bombs in a finer ash matrix)
-   Layers that have been partially mixed together by tectonic, biotic, climatic, or anthropic forces.

These layers may require some additional parameters or notes to adequately describe but do not need to be split excessively.
:::

## Defining the soil surface {#sec-pr-ssurf}

The soil surface has a slightly more restrictive definition than the land surface. The soil surface begins below the layer of fresh leaf litter or small living plants, and at the top of organic soil materials such as decomposing litter or peat. The mineral soil surface is further restricted, identified as the top of the first horizon that is dominated by mineral soil material. Horizon depths are defined with reference to the soil surface overall - thus only fresh litter and/or small plants should be scraped back before measuring.

[draw this]{.diags}

## Recording depths {#sec-pr-depths}

Horizon depths are recorded starting from the soil surface at 0 cm and working downwards cumulatively.

When examining single small cores or auger points (see @tbl-pr-gear, type [A]{.ceg}, [C1]{.ceg} and perhaps [C2]{.ceg}), record the observable upper and lower boundary depths of each horizon from the soil surface in whole centimetres (e.g. [28-38 cm]{.ceg}).

Where a wider exposure (see @tbl-pr-gear, type [E]{.ceg}, [P1]{.ceg}, [P2]{.ceg}) or multiple undisturbed cores are available and greater detail is desired, one may choose to record upper and lower boundary depths as a median and range, again in whole centimetres (e.g. [28 cm (27-29), 38 cm (37-40)]{.ceg}). At least 5 measurements should contribute to such an assessment. This practice may be useful for describing irregular, convolute or discontinuous horizons (@sec-pr-bdyshp).

Measure boundaries to and from the midpoint of each horizon transition zone (see @sec-pr-bdydist). Where depths are correctly measured, horizon thicknesses can be calculated after fieldwork.

::: {#imp-stp .callout-important collapse="true" appearance="simple" title="Defining horizons on steep slopes"}
On steeper slopes, measuring horizons from vertical exposures can exaggerate horizon thicknesses, as the soil horizons mantle the landscape perpendicular to the sloping surface [@prietzel2019]. This starts to matter at slopes \> 25°, and progressively becomes more important - especially when calculating volumetric stocks of soil components. @fig-hr-slpex shows how a vertical 30-cm depth represents a progressively shallower 'true depth' as slope increases.

Where depths are measured perpendicular to the surface, no adjustment needs to be made. To adjust vertically measured horizon depths to correct for slope, apply the formula $depth * cos(slope)$. Supply depth in cm and slope in radians. Slopes measured in degrees can be converted to radians using the formula $(slope * pi) / 180$. If this correction is made, record that it has been done in the site notes to prevent the horizon depths from being adjusted any further.

```{r}
#| label: fig-hr-slpex
#| fig-cap: "Depth exaggeration by slope."

deg2rad <- function(deg) {(deg * pi) / (180)}

slp_dat <- data.frame('Slope' = seq(0, 50, 1),
                      'Thickness' = 30 * cos(deg2rad(seq(0, 50, 1)))) |>
                        mutate('Ratio' = Thickness/30)

ggplot(slp_dat) +
  geom_line(aes(y = Thickness, x = Slope),
            linewidth = 1, colour = 'grey40') +
  labs(x= 'Slope (°)', y = 'Horizon thickness (cm)') +
  theme_minimal()

```
:::

## Boundary shape {#sec-pr-bdyshp}

Horizon boundary shape can only be observed on wider exposures (see @tbl-pr-gear, type [E]{.ceg}, [P1]{.ceg}, [P2]{.ceg}). Record using one of the options in @tbl-hr-bshp. Note that the boundary shape is associated with the lower boundary of any given horizon, so the lowest horizon described on a profile may have an undefined boundary shape if profile exposure stopped early (@sec-pr-rsa). In that case, use code [N]{.ceg}.

```{r}
#| label: tbl-hr-bshp
#| tbl-cap: "Horizon boundary shape"

dat_hr_bshp <-
  tribble(~Code, ~Name, ~Description,
          'S', 'Smooth', 'the boundary surface is a plane with few or no irregularities and usually occurs at the same depth across the profile face', 
          'W', 'Wavy', 'the boundary surface has broad, shallow, relatively regular pockets and none deeper than they are wide',
          'I', 'Irregular', 'the boundary surface has pockets which are deeper than they are wide but not recurved',
          'C', 'Convolute', 'the boundary surface has pockets which are deeper than they are wide and, in parts, recurved',
          'D', 'Discontinuous', 'the boundary is discontinuous, usually due to external disturbance',
          'N', 'Not observed', 'the lower horizon boundary could not be observed')

tbl_hr_bshp <- gt(dat_hr_bshp) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  cols_width(Code ~pct(10), Name ~pct(20))

tbl_hr_bshp
```

## Boundary distinctness {#sec-pr-bdydist}

Horizon boundaries mark changes in soil properties over short vertical distances. The distinctness is variable, from very sudden to gradual, and can signify particular soil characteristics (e.g. a change in parent material). Horizon boundary distinctness is used when classifying soils. Measure the distinctness of a horizon's lower boundary in terms of its width. Report a median and range in 0.1 centimetre increments (e.g. [2.0 cm +/- 0.5 cm]{.ceg}).

For rapid assessment, horizon boundary distinctness can be noted using one of the options in @tbl-hr-bdst.

```{r}
#| label: tbl-hr-bdst
#| tbl-cap: "Horizon boundary distinctness"

dat_hr_bdst <-
  tribble(~Code, ~Name, ~Description,
          'S', 'Sharp', '< 0.5 cm', 
          'A', 'Abrupt', '≥0.5–<2.0 cm',
          'C', 'Clear', '≥2.0–<5.0 cm',
          'G', 'Gradual', '≥5.0–<10.0 cm',
          'D', 'Diffuse', '≥10–<30.0 cm',
          'N', 'Not observed', 'the lower horizon boundary could not be observed')

tbl_hr_bdst <- gt(dat_hr_bdst) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red',
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  cols_width(Code ~pct(10), Name ~pct(20))

tbl_hr_bdst
```

Where a transition is thicker than 30 cm, it should be defined as a new horizon. Use transitional horizon names as needed (see @sec-hor-tran).

[put a diagram unifying the previous three concepts here]{.diags}

## Infill features {#sec-pr-inf}

Infill features are interruptions to the horizonation pattern caused by relatively recent biological or physical disturbances. Infill features are large enough that they can usually only be clearly observed at exposures or large pit faces. The interruption may extend across several horizons, and the infilled material may be from adjacent horizon(s) or comprise reworked material from the affected horizon(s). Where infill features are present, note the type using the options in @tbl-hr-infl, the horizons affected, and the infill material using the options in @tbl-hr-infm. 

E.g., [C (1-3) T]{.ceg} for infilled shrink-swell cracks extending from the surface to the third horizon.

Note that open subsurface voids should be described as per @sec-void, and open surface cracks as per @sec-pr-crack.

```{r}
#| label: tbl-hr-infl
#| tbl-cap: "Infill feature types"

dat_hr_infl <-
  tribble(~Code, ~Name, ~Description,
          'C', 'Crack',  'Infilled surface crack caused by shrink-swell clay movement',
          'T', 'Tunnel', 'Infilled animal burrow > 20 mm diameter',
          'B', 'Burrow', 'Infilled animal burrow <= 20 mm diameter', 

          'R', 'Root',   'Infilled root channel',
          'D', 'Drain',  'Infilled mole drain or similar deep-tillage feature')

tbl_hr_infl <- gt(dat_hr_infl) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red',
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  cols_width(Code ~pct(10), Name ~pct(15))

tbl_hr_infl
```

```{r}
#| label: tbl-hr-infm
#| tbl-cap: "Infill feature material"

dat_hr_infm <-
  tribble(~Code, ~Name, ~Description,
          'T', 'Topsoil',  'Infilled by topsoil material (in non-topsoil horizons)',
          'S', 'Subsoil',  'Infilled by subsoil material (in topsoil or regolith horizons)',
          'O', 'Organic',  'Infilled by organic material',
          'L', 'Local',    'Infilled by reworked material from the same horizon',
          'M', 'Mixed',    'Infilled by mixed materials from multiple horizons')

tbl_hr_infm <- gt(dat_hr_infm) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red',
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  cols_width(Code ~pct(10), Name ~pct(15))

tbl_hr_infm
```

## Soil moisture status {#sec-pr-sws}

Report soil moisture status for each horizon at the time of observation. This parameter supports assessments of drainage and permeability, and contextualises consistence tests.

```{r}
#| label: tbl-hr-soilmst
#| tbl-cap: "Soil water status (adapted from @griffiths1985)."

dat_hr_bdst <-
  tribble(~Code, ~Name, ~Sands, ~Light, ~Medium, ~Clays,
          'D', 'Dry', 'Loose, single grain', 'Loose', 'Easily broken down to powder', 'Hard, baked, cracked',
          'T', 'Moderately moist', 'Will not form a ball', 'Forms weak ball, breaks easily', 'Forms a ball, very pliable', 'Forms a ball, somewhat pliable',
          'M', 'Moist', 'Forms very weak ball', 'Forms weak ball, breaks easily', 'Forms a ball, very pliable', 'Easily forms a ball',
          'W', 'Wet', 'Fluid, non-plastic, non-sticky', 'Slightly fluid, slightly plastic', 'Deformable, plastic', 'Semi-deformable, very plastic',
          'S', 'Saturated', 'Water films visible, or below water table',  '',  '', '')

tbl_hr_bdst <- gt(dat_hr_bdst) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red',
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  tab_style(style = list(cell_text(align='center', style='italic')),
            locations = cells_body(columns = 3:6, rows = 5)) |>
  tab_spanner(label = 'Behaviour of the fine earth fraction',
              columns = Sands:Clays) |>
  cols_label(Sands = '> 80% Sand',
             Light = html("< 80% Sand<br />< 18% Clay"),
             Medium = html('> 18% Clay<br />< 35% Clay'),
             Clays = '>35% Clay') |>
  cols_merge(columns = 3:6, hide_columns = FALSE, rows = 5 ) |>
  cols_width(Code ~pct(10), Name ~pct(15))

tbl_hr_bdst
```

## Depth to free water

Depth to free water can be determined from the upper depth of the uppermost [S]{.ceg} saturated horizon (@tbl-hr-soilmst), or may be recorded directly, in whole centimetres. Depending on the soil's transmissivity, the water table may be also become evident by the pit or core filling with water. In this case, wait for the water level to stabilise before measuring.

-   If the water table is not encountered, record [NA]{.ceg}
-   If the water table is encountered, use @tbl-hr-frw to code its position in the profile, then record its depth above or below the soil surface in whole centimetres. Do not record negative numbers to signify a water table above the surface.
-   If the water table is exactly at the soil surface, record ['B 0']{.ceg}.

e.g. ['B 80']{.ceg} for a profile saturated below 80 cm depth; ['A 1']{.ceg} for a saturated and barely-walkable peat.

```{r}
#| label: tbl-hr-frw
#| tbl-cap: "Free water location"

dat_hr_frw <-
  tribble(~Code, ~Name, ~Description,
          'NA', 'Not applicable', 'Water table not encountered',
          'B', 'Below', 'Water table observed below the soil surface',
          'A', 'Above', 'Water table observed at or above the soil surface')

tbl_hr_frw <- gt(dat_hr_frw) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  cols_width(Code ~pct(10), Name ~pct(20))

tbl_hr_frw
```

## Parent materials {#sec-pr-pm}

Information about the lithology, origin and weathering degree of the soil parent materials is essential for accurate classification and helps contextualise analytical data.

### Lithology {#sec-pr-lith}

The lithology of the fine earth (mineral particles <2 mm) and of rock fragments (if present) are noted separately for each soil horizon. Where weathering substrate layers are observed, their lithology is also noted. Use the codes in @tbl-ss-pm. 

Example: [An, Hs]{.ceg} for a mix of eroded sedimentary rocks and volcanic ash.

### Degree of weathering {#sec-sedweath}

The effects of weathering and pedogenesis vary down-profile (usually, but not always, decreasing with depth). Horizons that have experienced limited weathering may require specific descriptors (e.g. texture (@sec-tex-rec) cannot be determined on slightly weathered rocks, but bedding (@sec-reg-bed) may need to be described), so the need for these should be assessed early in the description process. Record degree of weathering once per horizon.

```{r}
#| label: tbl-hr-wdeg
#| tbl-cap: "Degree of weathering"

dat_hr_wdeg <-
  tribble(~Code, ~Name, ~Description_c, ~Description_u,
          1, 'Unweathered', 'Material shows no discolouration, loss of strength, or any other effects due to weathering', 'Particles are uncoated and their physical arrangement has not been disturbed (e.g. visible cross-bedding, absence of burrows). Secondary minerals and precipitates are absent',
          2, 'Slightly weathered', 'Material may be slightly discoloured compared to its unweathered state. Discontinuities have discoloured surfaces. The rock material is not significantly weaker than fresh rock material', 'Particle physical arrangement is undisturbed, but some evidence of secondary mineral formation may be evident (e.g. pyrite formation in anoxic marine sediments)',
          3, 'Moderately weathered', 'Rock material is discoloured and discontinuity surfaces will have a greater discolouration which also penetrates slightly into the rock material. The rock material is significantly weaker than the fresh rock and part of the rock mass may have been changed to soil material.', 'Sediments may be largely discoloured by secondary mineral precipitation or illuviation; some clay minerals may have weathered from the material, some physical disturbance by meso- or macrofauna may be apparent',
          4, 'Highly weathered', 'Rock material is discoloured and more than half the rock mass is changed to soil material. Weathering adjacent to discontinuities penetrates deeply into the rock material but lithorelicts or core stones of fresh or slightly weathered rock may still be present.', 'Sediments show substantial alteration by weathering processes as evidenced by e.g. clay mineral production, presence of secondary materials and perhaps some structural development. Evidence of bedding may be absent or difficult to identify',
          5, 'Very highly weathered', 'All the rock mass is decomposed and externally changed to soil material, but the original rock fabric is mainly preserved.', 'Sediments have largely changed to soil material, but the expression of features like structure may be weak relative to adjacent layers',
          6, 'Completely weathered',  'Rock is completely changed to soil material with the original fabric completely destroyed but the resulting soil is not significantly transported.', 'Sediments have completely changed to soil material')

tbl_hr_wdeg <- gt(dat_hr_wdeg) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red',
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  cols_label(Description_c = "Rock and rock fragments",
             Description_u = "Unconsolidated mineral materials") |>
  cols_width(Code ~pct(10), Name ~pct(20))

tbl_hr_wdeg
```

### Parent material origin {#sec-pr-orig}

Parent material origin, or mode of emplacement, describes how soil parent materials have arrived at the point of observation. Multiple modes may have operated in different parts of the soil profile.

Record one parent material origin code per soil horizon, using the codes in @tbl-ss-pmo. At the horizon level, the [An]{.ceg} Anthropic class can be subdivided by origin using the codes in @tbl-hr-antype (e.g. [Ann]{.ceg} for a fill pad in a residential housing development).

Note that parent material origin, when summarised on a whole-profile basis, is the final defining factor of the soil Family within the *New Zealand Soil Classification* [@webb2011]. 

```{r}
#| label: tbl-ss-pmo
#| tbl-cap: "Parent material origin"

dat_ss_pmo <-
  tribble(~Code, ~Name, ~Description,
          'An', 'Anthropic', 'Deposits made by the direct actions of humans, including truncation, mixing, or deposition.',
          'Cl', 'Colluvium', 'Weathered soil and rock material mantling slopes that has been transported primarily by gravity and sheet wash.',
          'Fl', 'Alluvium', 'Sediments that have been deposited by streams, rivers and other running water.',
          'Gl', 'Glacial till', 'Poorly stratified, poorly sorted rock fragments, sand and mud, surface or near-surface deposits resulting from the transportation by and deposition from ice or meltwater from beneath or in close proximity to glacial ice.',
          'Lc', 'Lacustrine', 'Formed in and around lake beds; comprising extremely fine sediment deposited under very low-flow freshwater conditions.',
          'Mr', 'Marine' , 'Unconsolidated sediments saturated by brackish or saline water.',
          'Lh', 'Lahar', 'A flow of volcanic material, both ash and coarser products, mixed with water; often caused by the spilling over of a crater lake. Also used to describe the mounds formed on volcanic ring-plains where lahars stop.',
          'Tp', 'Tephra', 'A general term for all solid (rather than molten) materials ejected from a volcano during an eruption: includes boulders, lapilli and ash.',
          'Li', 'Litter', 'Partly or fully decomposed forest litter, equal to or greater than 30 cm depth that is **not** almost continually saturated in the natural state (**F** and **H** horizons).',
          'Pt', 'Peat', 'Partly decomposed plant remains in a water-saturated environment, such as a bog',
          'Lo', 'Loess', 'A blanket deposit of silt-sized particles (0.002--0.06 mm diameter); usually carried by wind from dry riverbeds or outwash plains during glacial and post-glacial periods.',
          'Sa', 'Aeolian sand', 'Wind-deposited sand-sized particles (0.05--2.0 mm diameter), i.e. dune sand.',
          'Rw', 'Highly Weathered Rock', '*In situ* highly to completely weathered lithified geologic material',
          'Rx', 'Rock', '*In situ* unweathered to moderately weathered lithified geologic material',
          'Uk', 'Unknown', 'Origin cannot be determined with certainty.'
          )

tbl_ss_pmo <- gt(dat_ss_pmo) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  fmt_markdown(columns = 3) |>
  cols_width(Code ~pct(10), Name ~pct(20))

tbl_ss_pmo
```

```{r}
#| label: tbl-hr-antype
#| tbl-cap: "Subtypes of Anthropic soil materials"

dat_hr_antype <-
  tribble(~Code, ~Name, ~Description,
          'm', 'Māori', 'Soil modifications dating from Polynesian arrival in New Zealand, particularly pre-modern soil management practices (i.e. early Māori)',
          'p', 'Pakeha', 'Soil modifications dating from Pakeha (non-Māori) arrival in New Zealand up to modern times (e.g. European agricultural practices)',
          'n', 'Modern', 'Anthropic modifications resulting from modern techniques or addition of modern materials to the soil (e.g. plastics)'
          )

tbl_hr_antype <- gt(dat_hr_antype) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red',
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  cols_width(Code ~pct(10), Name ~pct(20))

tbl_hr_antype
```

