```{r}
library(dplyr)
library(tibble)
library(gt)
library(gtExtras)
```

# Horizon names

## Conventional horizons

Horizon names operate as a shorthand for describing the full profile, making it easier to compare and contrast groups of profiles, and easier to classify them. Horizons are given a particular designation according to their position in the profile and according to soil properties that reflect the kind and degree of pedogenic alteration. As designations are made in the field, they are defined mainly by morphological properties that differentiate horizons from those above or below, or from a presumed parent material. Laboratory data may be needed to confirm identification, especially in marginal cases. This scheme was developed from the system used in England and Wales [@avery1980] by Clayden and Hewitt [-@clayden2015], and is broadly similar to those used overseas (e.g. WRB [-@iussworkinggroupwrb2022]). However, note that significant differences in suffix use exist between all of these systems as they have become adapted to regional conditions.

### Primary Divisions

These codes can be used by themselves for rapid assessment, or where criteria for secondary divisions are not met.

```{r}
#| label: tbl-hr-horprime
#| tbl-cap: "Primary horizon divisions"

dat_hr_horprime <-
  tribble(~Code, ~Name, ~Description,
          'L', 'Litter', 'Fresh litter deposited during the previous annual cycle. It is normally loose and the original plant structures are little altered.',
          'F', 'Fibric', 'Partly decomposed litter deposited or accumulated at the surface and not saturated with water for more than ~1 month at a time.',
          'H', 'Humic', 'Well-decomposed litter deposited or accumulated at the surface and not saturated with water for more than ~1 month at a time. Original plant structures cannot be seen.',
          'O', 'Peat', 'Organic horizon accumulated under wet conditions. It is saturated with water for at least 30 consecutive days in most years, or has been artificially drained.',
          'A', 'Surface', 'Mineral horizon formed at the surface, or below an organic horizon. It is characterised by incorporation of humified organic matter, or properties resulting from disturbance by cultivation. The organic matter has been incorporated by biological activity or by mixing through cultivation rather than by translocation.',
          'E', 'Eluviated', "Subsurface mineral horizon that contains less organic matter and/or iron and/or clay than the horizon immediately below, as a result of downward or lateral movement.

It is identified by having all of the following: 

1.  A moist colour value of 4 or more, or a dry colour value of 5 or more, with or without silty or sandy coatings (skeletans, @brewer1964), observable in a dry specimen.
2.  Higher colour value or lower chroma and less well developed pedality than an underlying B horizon.
3.  Less organic matter and higher colour value than an overlying H, O or A horizon.
          
The colour of the horizon can be that of uncoated sand and silt grains but E horizons are also recognised where coats of iron oxides or other minerals mask the colour of the primary particles." ,
          'B', 'Subsoil', "Subsurface mineral horizon without rock structure (including fine stratification in soft sediments), characterised by one or more of the following:

1.  Illuvial concentration of silicate clay, iron, aluminium or organic matter, alone or in some combination. 
2.  Coatings of sesquioxides that give the horizon a lower colour value, a higher chroma, or redder hue than the horizons above and below, without apparent illuviation of iron.
3.  Alteration that has formed silicate clay or liberated oxides or both, and that leads to ped formation.
4.  Evidence of solution and removal of carbonates.
          
A B horizon is differentiated from adjacent horizons by moist and dry colour and/or pedality and normally underlies an A or E horizon.",
          'C', 'Regolith', 'Unconsolidated or weakly consolidated mineral horizon that is little affected by pedogenic processes and lacks properties of A, E or B horizons. The material may be either like or unlike that from which the solum presumably formed.

A C horizon may have been modified by: 
          
1.  Gleying and other processes caused by saturation with water.
2.  Accumulation of carbonates or more soluble salts.
          
Some highly weathered materials like saprolite are designated C if the material does not meet the requirements of A, E or B horizons. ',
          'R', 'Rock', 'Hard or very hard bedrock that is impracticable to dig with a spade.'
          )

tbl_hr_horprime <- gt(dat_hr_horprime) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red',
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  tab_style(style = "vertical-align:top",
            locations = cells_body(columns = c(1, 2))) |>
  fmt_markdown(columns = 3) |>
  cols_width(Code ~pct(10), Name ~pct(20))

tbl_hr_horprime

```

### Secondary Divisions

#### O horizons {#sec-hor-o}

```{r}
#| label: tbl-hr-hortwoorg
#| tbl-cap: "Secondary O horizon divisions"

dat_hr_hortwoorg <-
  tribble(~Code, ~Name, ~Description,
          'Of', 'Fibric peat' , 'Peat dominated by well-preserved plant remains, with at least 75% fibre content after rubbing (e.g. preserved timber)',
          'Om', 'Mesic peat', 'Peat intermediate in composition between Of and Oh.',
          'Oh', 'Humic peat', 'Peat dominated by strongly decomposed plant remains, with less than 15% fibre content after rubbing. Plant species cannot be directly identified.')

tbl_hr_hortwoorg <- gt(dat_hr_hortwoorg) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  tab_style(style = "vertical-align:top",
            locations = cells_body(columns = c(1, 2))) |>
  cols_width(Code ~pct(10), Name ~pct(20))

tbl_hr_hortwoorg
      
```

-   Add the [p]{.ceg} suffix wherever the [O]{.ceg} horizon is affected by cultivation e.g. [Ohp]{.ceg}.

#### A Horizons {#sec-hor-a}

```{r}
#| label: tbl-hr-hortwoa
#| tbl-cap: "Secondary A horizon divisions"

dat_hr_hortwoa <-
  tribble(~Code, ~Name, ~Description,
          'Ah', 'Natural' , 'An A horizon in which there is no evident disturbance due to cultivation or pastoral land use.',
          'Ap', 'Agricultural', 'An A horizon in which incorporation of organic matter has involved mixing due to cultivation or to increased biological activity associated with topdressing or manuring. It may contain material from pre-existing E, B or C horizons.',
          'App', 'Recently tilled', 'An Ap horizon consisting mainly of clods and fragments with little pedal material, caused by cultivation during the past year.')

tbl_hr_hortwoa <- gt(dat_hr_hortwoa) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  tab_style(style = "vertical-align:top",
            locations = cells_body(columns = c(1, 2))) |>
  cols_width(Code ~pct(10), Name ~pct(20))

tbl_hr_hortwoa
```

-   Add the [g]{.ceg} suffix wherever the [A]{.ceg} horizon has ≥ 2% redox segregations.\
    *Note:* As [A]{.ceg} horizons are expected to generally be dark and/or low-chroma from elevated organic matter, the [other redox modifiers](#sec-hor-redox) available in deeper horizons may not be applied.

#### E horizons {#sec-hor-e}

```{r}
#| label: tbl-hr-hortwoe
#| tbl-cap: "Secondary E horizon divisions"

dat_hr_hortwoe <-
  tribble(~Code, ~Name, ~Description,
          'Ea', 'Leached' , 'No redox segregations; grains largely uncoated. Can be very pale if quartz-dominated. Rarely saturated, usually overlies Bh or Bs.',
          'Ew', 'Weathered', "Both of the following:

1.  a moist chroma of 4 or more but less than 6, *and* 
2.  \\< 2% redox segregations.")

tbl_hr_hortwoe <- gt(dat_hr_hortwoe) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  tab_style(style = "vertical-align:top",
            locations = cells_body(columns = c(1, 2))) |>
  fmt_markdown(columns = 3) |>
  cols_width(Code ~pct(10), Name ~pct(20))

tbl_hr_hortwoe
```

#### B Horizons {#sec-hor-b}

```{r}
#| label: tbl-hr-hortwob
#| tbl-cap: "Secondary B horizon divisions"

dat_hr_hortwob <-
  tribble(~Code, ~Name, ~Description,
          'Bfm', 'Placic' , "Sharply defined, cemented, pan-like B horizon usually less then 10 mm thick but the same designation is given to horizons up to 25 mm thick. It is black to reddish brown or dark red in colour, and a black upper part can often be distinguished from a reddish brown lower part. It lies roughly parallel to the soil surface but is commonly wavy or convolute. A Bfm horizon usually occurs as a single pan but in places it can be bifurcated. It forms a barrier to most roots and restricts water movement.

The Bfm horizon is equivalent to the concept of the placic horizon (Soil Survey Staff 1975) except that New Zealand ironpans are enriched in iron and organic matter without significant accumulations of manganese [@clayden1990].",
          'Bw', 'Weathered', "Both of the following:
1.  a moist chroma of 4 or more but less than 6, *and*
2. \\< 2% redox segregations.",
'Bh', 'Humose', 'Dark-coloured B horizon of podzolised soils enriched in organic matter, associated with aluminium, or iron and aluminium, as a result of illuviation.

It has a moist value and chroma of 3 or less, or a value of 4 if chroma is 2, dominant in the matrix, and contains 1% or more organic carbon. The fabric has sand- or silt- size pellet-like aggregates, coats on mineral grains, or both. In some horizons (including humus-pans, **Bhm**), coatings have coalesced to fill pores and cement the horizon.',
'Bo', 'Ochreous', "A strongly weathered B horizon formed in mixed crystalline iron and aluminium oxides and kaolin minerals, with low activity clay properties. It must meet all the following requirements:

1.  Weak primary ped and soil strength at moist to dry soil water states.
2. Unconfined failure is friable or very friable over very moist to dry soil water states. Materials fail to predominantly 3 mm or smaller microaggregates comprising silt- and sand-sized polyhedra and spheroids.
3. Primary peds slake rapidly in water to stable microaggregates which show no or slight dispersion after 100 inversions using the method of [@mcqueen1981].
4. Negative reaction to the sodium fluoride test [@fieldes1966]. 

Bo horizons are clayey with measured clay contents commonly exceeding 60%. Measured clay % is usually larger than in overlying A horizons, but clay increase is not a defining criterion due to the difficulties of clay measurement in materials that are frequently difficult to disperse. Materials are only slightly sticky and plastic in relation to clay content. Clay coatings are either absent or only present at frequencies of about 1%. The Bo horizon has low activity clay accessory properties with ECEC and CEC less than 12 and 16 me.100 g clay respectively.",
'Bs', 'Sesquioxides', "Ochreous B horizon of podzolised soils containing illuvial aluminium, iron, or both, that is closely associated, or complexed, with illuvial organic matter. The aluminium and iron is apparently mainly present as minerals with short-range order (especially allophane and ferrihydrite), though some aluminium is often present as aluminium-humus.

The designation Bs should be used for B horizons that:

1. occur below an Ea, Bh, Bfm or a strongly acid A horizon, and
2. have a moist value and chroma both of more than 3, and
3. have a rapid positive reaction to the sodium fluoride test. 

It is not possible to define the morphology of a Bs horizon such that it can be distinguished from certain Bw horizons enriched in iron and aluminium due to weathering *in situ*.

Characteristic features of **Bs** horizons are:   

1.  Reddest hue and highest chroma at the top of the horizon.
2. Earthy apedal fabric with fine spheroids, or weakly developed blocks or polyhedrons.
3. Very weak or moderately weak soil strength when moist or dry.
4. A greasy or smeary feel when very moist.
5. Low plasticity in relation to clay content.
6. Sand- or silt-size pellet-like aggregates, sesquioxidic coats on mineral grains or both.",
'Bt', 'Translocated', "B horizon containing translocated clay. It is required to have

1.  clay coatings that have a waxy lustre when dry and/or sufficient thickness to envelop fine sand grains, on ped faces or in pores, lamellae, or forming bridges between mineral grains, or
2. if there is an overlying E or AE horizon with no lithological discontinuity at its base, sufficiently more clay than the eluvial horizon to be detectable by hand texturing (i.e. 5% more clay).",
'Bw', 'Weathered', "B horizon that shows evidence of alteration under well aerated conditions and does not qualify as Bh, Bs or Bt.

To qualify as a Bw rather than BC or C it must meet at least one of the following requirements:

1.  Redder hue or higher chroma than an underlying horizon in similar materials ('colour B').
2. Have spheroids, blocks, polyhedrons, tablets, prisms, columns or plates which distinguish the horizon from a BC or C horizon below ('structural B').
3. Evidence of either partial or complete decalcification, i.e. less CaCO~3~ than the underlying horizon which may contain redeposited carbonates.

A Bw horizon has less than 2% redox segregations. It is otherwise distinguished by the following colour requirements: 

1.  With moist values less than 5, chromas must be 3 or more.
2. With moist values 5 or more, chromas must be 4 or more.",
'BC', 'B-ish', "A horizon transitional in character between a B and a C horizon, usually below a B horizon. It is distinguished from a B horizon in similar material by lacking some required characteristic of colour, pedality or degree of weathering. It differs from a C horizon by having some B horizon feature, albeit weakly expressed.
The same designation is also applied to morphologically similar subsurface horizons in profiles without a B horizon."
)

tbl_hr_hortwob <- gt(dat_hr_hortwob) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  tab_style(style = "vertical-align:top",
            locations = cells_body(columns = c(1, 2))) |>
  fmt_markdown(columns = 3) |>
  cols_width(Code ~pct(10), Name ~pct(20))

tbl_hr_hortwob
```

#### C Horizons {#sec-hor-c}

```{r}
#| label: tbl-hr-hortwoc
#| tbl-cap: "Secondary C horizon divisions"

dat_hr_hortwoc <-
  tribble(~Code, ~Name, ~Description,
          'CR', 'Consolidated' , "A weakly consolidated C horizon that is sufficiently dense and coherent to form a significant barrier to roots. Soft rocks (with a hardness on Moh's scale of < 3) such as shale and siltstone, and some exceptionally dense glacial tills are included. The material can be dug with difficulty with a spade when moist.

The concept of the CR horizon is similar to that of the material underlying a paralithic contact, but without the restrictive requirement for the spacing of cracks.",
          'Cu', 'Unconsolidated', "Unconsolidated C horizon without evidence of strong gleying, accumulation of carbonates or more soluble salts. It is normally apedal, may show stratification and has less than 2% redox segregations.")

tbl_hr_hortwoc <- gt(dat_hr_hortwoc) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  tab_style(style = "vertical-align:top",
            locations = cells_body(columns = c(1, 2))) |>
  cols_width(Code ~pct(10), Name ~pct(20))

tbl_hr_hortwoc
```

#### R Horizons {#sec-hor-r}

```{r}
#| label: tbl-hr-hortwor
#| tbl-cap: "Secondary R horizon divisions"

dat_hr_hortwor <-
  tribble(~Code, ~Name, ~Description,
          'R', 'Rock' , "Hard or very hard bedrock that is impracticable to dig with a spade. The rock may contain cracks, but these are generally too few and too small for significant root development. However, trees and shrubs do root into fissures in R horizons and the definition is intended to be broader than the specifications for rock material below a lithic contact.")

tbl_hr_hortwor <- gt(dat_hr_hortwor) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  tab_style(style = "vertical-align:top",
            locations = cells_body(columns = c(1, 2))) |>
  cols_width(Code ~pct(10), Name ~pct(20))

tbl_hr_hortwor
```

#### Transitional Horizons {#sec-hor-tran}

Apart from the BC and CR described above, Two main kinds of transitional horizons are distinguished by specific conventions.

1.  Transitional horizons having properties of two master horizons as in gradational horizons in vertical sequence, e.g. **Ap**, **AB**, **Bw**. In other cases a horizon can be designated as transitional even if one of the master horizons to which it is apparently transitional is not present. For example, an **AB** horizon can be recognised where the underlying layer is bedrock (**R**), and a **BC** horizon can be recognised even if no underlying **C** horizon is identified.  Lower case suffixes are used following the two capital letters where the property denoted by the suffix applies to the whole horizon, e.g., **ABg**, **BCt**, **BCx**.
2.  Transitional horizons in which discrete parts have recognisable properties of two kinds of master horizon, e.g., where pieces of **A** horizon are incorporated in a **B** horizon or where horizons interfinger. In this case the horizon is designated by two capital letters separated by a solidus, e.g. **B/C**. Appropriate suffixes should be used where the components of the material are clearly identifiable, e.g. **Ap/Bw**.

For simplicity the capital letters for all transitional horizons are used in the order A, E, B, C irrespective of which properties dominate. For example, all horizons transitional between A and B horizons are designated AB or A/B, with suffixes as appropriate.

### Redox suffixes {#sec-hor-redox}

The following suffixes can be added to most [E]{.ceg}, [B]{.ceg}, or [C]{.ceg} horizons to signify the degree to which they have been affected by water saturation and reducing conditions, e.g. [Bg]{.ceg}. Some exceptions exist:

-   [g]{.ceg} and [r]{.ceg} suffixes cannot be used with [Ew]{.ceg} or [Bw]{.ceg} horizons, which are defined by their development under well-aerated conditions.
-   [g]{.ceg} and [r]{.ceg} suffixes cannot be used with [Cu]{.ceg}, as it is partly defined by a lack of strong gleying.

Per below, low-chroma colours have:

-   moist chroma of 2 or less, *or*
-   moist chroma of 3 with values of 6 or more.

```{r}
#| label: tbl-hr-horredox
#| tbl-cap: "Redox suffixes"

dat_hr_hortwor <-
  tribble(~Code, ~Name, ~Description,
          '*no code*', 'Unaffected' , "< 2% redox segregations, no low-chroma colours",
          '(f)', 'Slightly reduced', '≥ 2% redox segregations, no low-chroma colours',
          '(g)', 'Reduced', '≥ 2% redox segregations, matrix and/or ped faces have < 50% low-chroma colours',
          'g' , 'Very reduced', '≥ 2% redox segregations, matrix has 50-85% low chroma colours, and/or ped faces have > 50% low-chroma colours',
          'r', 'Completely reduced', 'Matrix has > 85% low-chroma colours.')

tbl_hr_hortwor <- gt(dat_hr_hortwor) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1, rows = 2:5)) |>
  tab_style(style = "vertical-align:top",
            locations = cells_body(columns = c(1, 2))) |>
  fmt_markdown(columns = 1, rows = 1) |>
  cols_width(Code ~pct(10), Name ~pct(20))

tbl_hr_hortwor
```

### Other suffixes {#sec-hor-other}

One or more of these suffixes may be added to the designations defined above to provide more specific information about a horizon. For example, a [Bg]{.ceg} horizon containing more than 5% by volume of concretions is designated [Bgc]{.ceg}.

```{r}
#| label: tbl-hr-horother
#| tbl-cap: "Other suffixes"

dat_hr_horother <-
  tribble(~Code, ~Name, ~Description,
          'c', 'Concretionary', '\\> 5% by volume of concretions. May be combined with **j**, **k**, **l**, **y**, or **z** to further define the nature of the concretions.',
          'd', 'Densipan', 'To denote an E horizon with densipan properties, usually **Erd**.
-   Either unconfined strength as measured by a resistance to crushing test is hard or very hard at soil water states from near wet to dry, *or* soil penetration resistance measured by a 6.5 mm flat-tipped penetrometer exceeds 4000 kPa at soil water states from near wet to dry, *and*
-   Moist and dry samples slake in water.',
'e', 'Unripe', 'To denote an unripe horizon, distinguished by having a moderately fluid or very fluid fluidity class.',
'(h)', 'Cutanic', 'To denote a horizon with cutanic horizon properties. It has dark coloured coats on ped faces, in pores and on rock fragments. The coats have a moist value of 4 or less, or value 5 and chroma 3, and are assumed to be a complex of organic matter with clay and/or sesquioxides. Similar features are described as organic coatings by @bullock1985 and as "organans" by @brewer1964.

In coarse textured, apedal horizons, the translocated material can penetrate the matrix to the extent that patches of the whole horizon have the colour given above. In such cases the horizon can only be distinguished from a **Bh** of a podzolised soil by its relationship to adjacent horizons, or by a negative reaction to the sodium fluoride test, except for soil in volcaniclastic materials. 

The suffix is used with **Bs**, **Bt**, **Bw** and **BC** horizons and also with **Ea**, **Eg** and **Er** horizons below hurnose or peaty surface layers.',
'i', 'Nodular', 'To denote that the horizon contains more than 15% by volume of nodules, subrounded or irregular segregations of iron or aluminium oxyhydroxides with some kaolin.',
'j', 'Jarositic', 'To denote the presence of straw-coloured jarosite, most commonly in **\\*g** or **\\*r** horizons.',
'k', 'Calcareous', ' To denote an accumulation of secondary carbonate, CaCO~3~.',
'l', 'Gibbsitic', 'To denote an accumulation of gibbsite, Al(OH)~3~.',
'm', 'Cemented', 'To denote a continuously cemented horizon that is strong enough to resist root penetration.',
'n', 'Sodic', 'To denote an accumulation of sodium (identified in the field).',
'q', 'Silicic', 'To denote an accumulation of secondary silica. A duripan is designated **q**.',
'v', 'Variegated', 'To denote a horizon with mottles or variegated colour pattern due to differential weathering of mineral components and not attributable to reduction and segregation of iron caused by saturation with water.',
'x', 'Fragic', 'To denote a horizon with fragipan properties, usually **BCxg**, **BCx(g)** or **BCx**.

A fragipan must fulfill **all** of the following requirements: 

1. An air-dried clod slakes when fully immersed in water. 
2. It has brittle failure when moist. The horizon may contain rock fragments, but the fine earth must be sufficiently coherent to allow brittle fracture. 
3. It has at least slightly firm moist soil strength.
4. Either 
  a. Extremely coarse or gross prismatic peds: the prisms have apedal-massive interiors, or break to secondary peds with horizontal dimensions of 100 mm or more, and the prism faces are defined by colours of chroma 3 or less, *or* 
  b. The horizon is apedal-massive throughout, or has extremely coarse or gross prismatic peds, and the moist soil strength is very firm. 
5. If roots are present, they are confined predominantly to planar voids between prisms or to worm galleries.
6. Moist penetration resistance measured by a 6.5 mm flat-tipped penetrometer is 3100 kPa or more. 
7. It does not occur within an **E** horizon. 

A fragipan usually has clay coatings on fissures or in pores between fissures. Their presence is not indicated by an additional suffix **t**. Likewise, the use of the additional suffix **p** with **\\*g** or **\\*(g)** to denote perched water is superfluous.', 
'(x)', 'Almost fragic', ' To denote a brittle horizon that does not meet all the requirements of a fragipan, e.g. **Bw(x)**.',
'y', 'Gypsic', 'To denote an accumulation of gypsum, CaSO~4~.',
'z', 'Salty', 'To denote an accumulation of salts more soluble than gypsum.')

tbl_hr_horother <- gt(dat_hr_horother) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  tab_style(style = "vertical-align:top",
            locations = cells_body(columns = c(1, 2))) |>
  fmt_markdown(columns = 3) |>
  cols_width(Code ~pct(10), Name ~pct(20))

tbl_hr_horother
```

### Lithological discontnuities

Numbers [1-*N*]{.ceg} may be used to signify lithological discontinuities, where the parent material changes significantly between layers e.g. [2C]{.ceg}. Such discontinuities are identified by a significant difference between adjacent horizons, in the particle-size distribution of fractions coarser than 2 µm or in mineralogy, that cannot be attributed to pedogenic processes and/or by significant differences in age.

The main purpose of recognising lithological differences is to draw attention to inherited layering that can significantly influence physical properties, particularly permeability. Horizons comprising the uppermost parent material layer are not specifically designated, the prefix 1 being understood. Those comprising succeeding layers are numbered 2, 3, etc. consecutively with depth. When the material below horizon 2 is similar to the material above horizon 2, it is still given the label 3. Where two or more consecutive horizons have formed in the same kind of material, the same prefix number is applied to all the horizons in the material, eg. **Ap**, **Ew**, **Bt1**, **2Bt2**, **2Bt3**, **2BC**.

### Numbering identical horizons

If a horizon needs be subdivided, append a number onto the end of the name. The horizon names must otherwise be identical, e.g. **Bt1**, **Bt2**, **Btg1**, **Btg2** is correct, but **Bt1**, **Bt2**, **Btg3**, **Btg4** is not. This convention can, however, cross lithological discontinuities, e.g. **Bw1**, **Bw2**, **2Bw3**, **2Bw4**.

### Buried horizons

Pedogenic horizons that have been buried by deposition of additional material and little modified subsequently are called buried horizons and denoted by the prefix 'b'. A buried horizon is obviously not in the same deposit as overlying horizons. Some buried horizons, however, are formed in material that is lithologically similar to the overlying deposit. The symbol is not used in Organic Soils or to separate an organic layer from a mineral layer.

The notation for a buried **Ah** horizon in material similar to the overlying deposit is **bAh**, and that for a buried **Ah** horizon in dissimilar material is **2bAh**.The horizons of a sequence of buried soils are given consecutive numbers for each soil following the prefix b, independently of the numbers for litholgical discontinuities that are placed before the b.

## Functional horizons {#sec-in-fh}

Functional horizons provide a shorthand for groups of soil morphology properties that have been linked to soil physical behaviour. Functional horizons help define level 5 of the New Zealand Soil Classification, the soil sibling (see @sec-in-sib).

### Code Components {#sec-in-fh-cc}

Each functional horizon is built from a set of components - topsoil status, tephric character, generalised stone and texture content, degree of structural development and consistence.

#### Topsoil {#sec-in-fh-ts}

```{r}
#| label: tbl-in-fhts
#| tbl-cap: "Functional horizon - topsoils"

dat_in_fhts <-
  tribble(~Code, ~Name, ~Description,
         't', 'Topsoil', 'Surface functional horizon(s) - conventional **A**, **AB** or **O** designation. **L/F/H** horizons are ignored. Must have more than 25% roots by volume.',
         'leave blank', 'Subsoil', 'Non-topsoil functional horizons. Conventional designation generally **B**, **E**, or **C**.')

tbl_in_fhts <- gt(dat_in_fhts) |>
  tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1, rows = 1)) |>
  tab_style(style = list(cell_text(style = 'italic')),
            locations = cells_body(columns = 1, rows = 2)) |>
  fmt_markdown(columns = 3) |>
  cols_width(Code ~pct(10), Name ~ pct(20))
  
tbl_in_fhts
```

The topsoil code can be prefixed to any horizon - it is not restricted to the first functional horizon in the profile. This enables buried topsoils or multi-horizon topsoils to be adequately described.

#### Tephric character {#sec-in-fh-vc}

```{r}
#| label: tbl-in-fhvc
#| tbl-cap: "Functional horizon - tephric materials"

dat_in_fhvc <-
  tribble(~Code, ~Name, ~Description,
         'z', 'Acidic tephric', 'Acidic tephra (rhyolite-sourced, or similar) that qualifies as allophanic or vitric soil material',
         'b', 'Basic tephric', 'Basic or intermediate tephra (basalt or andesite-sourced, or similar) that qualifies as allophanic or vitric soil material',
         'leave blank', 'Non-tephric', 'non-volcanic materials, or volcanic materials that do not qualify as allophanic or vitric soil material')

tbl_in_fhvc <- gt(dat_in_fhvc) |>
  tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1, rows = 1:2)) |>
  tab_style(style = list(cell_text(style = 'italic')),
            locations = cells_body(columns = 1, rows = 3)) |>
  cols_width(Code ~pct(10), Name ~ pct(20))
  
tbl_in_fhvc
```

Tephric codes cannot be used in combination with [O\*]{.ceg}, [J]{.ceg} or [Q]{.ceg} functional horizon textures (see below).

#### Stone content {#sec-in-fh-stone}

Use the volumetric stone content assessments made in @sec-rockfrag to classify stone content of functional horizons.

```{r}
#| label: tbl-in-fhst
#| tbl-cap: "Functional horizon - stone content"

dat_in_fhst <-
  tribble(~Code, ~Name, ~Description,
         'S', 'Stony', '> 5% - 35%',
         'V', 'Very stony', '> 35% - 70%',
         'X', 'Extremely stony', '> 70%', 
         'leave blank','Non-stony', '≤ 5%')

tbl_in_fhst <- gt(dat_in_fhst) |>
  tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1, rows = 1:3)) |>
    tab_style(style = list(cell_text(style = 'italic')),
            locations = cells_body(columns = 1, rows = 4)) |>
  cols_width(Code ~pct(10), Name ~ pct(20))
  
tbl_in_fhst
```

#### Texture {#sec-in-fh-tx}

```{r}
#| label: tbl-in-fhtx
#| tbl-cap: "Functional horizon - texture class"

dat_in_fhtx <-
  tribble(~Code, ~Name, ~Description,
         'A', 'Sandy',          'Sand and Loamy Sand [texture classes](hr_03_texture.qmd#sec-hr-tex)',
         'L', 'Loamy or Silty', 'Loamy and Silty [texture classes](hr_03_texture.qmd#sec-hr-tex)',
         'Y', 'Clayey',         'Clayey [texture classes](hr_03_texture.qmd#sec-hr-tex)', 
         'O', 'Organic',        'Organic soil materials',
         'J', 'Fluid',          'Moderately or very fluid',
         'Q', 'Pan',            'Indurated pan',
         'P', 'Placic',         'Placic horizon')

tbl_in_fhtx <- gt(dat_in_fhtx) |>
  tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  fmt_markdown(columns = 3) |>
  cols_width(Code ~pct(10), Name ~ pct(20))
  
tbl_in_fhtx
```

-   Texture [J]{.ceg} is used where fluid behaviour is observed (generally in saturated loose fine sediments below the permanent water table) and is not used in concert with any other codes.
-   Texture [Q]{.ceg} is used where a pan is observed and is not used in concert with any other codes.
-   Texture [P]{.ceg} is used where a placic horizon is observed and is not used in concert with any other codes.

#### Texture suffixes {#sec-in-fh-tx2}

```{r}
#| label: tbl-in-fhtxx
#| tbl-cap: "Functional horizon - texture class modifiers"

dat_in_fhtxx <-
  tribble(~Code, ~Name, ~Description,
         'a', 'Dune sand', 'Clean, [medium to coarse sand](hr_03_texture.qmd#tbl-hr-sandquals)',
         'x', 'Fragmental', '\\> 85% rock fragments with minimal interstitial material',
         'h', 'Humified', 'Non-fibrous peats - conventional horizons **Om**, **Oh**', 
         'r', 'Fibrous',  'Fibrous peats and thick litter layers - conventional horizons **Of**, **H**, **F**')

tbl_in_fhtxx <- gt(dat_in_fhtxx) |>
  tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  fmt_markdown(columns = 3) |>
  cols_width(Code ~pct(10), Name ~ pct(20))
  
tbl_in_fhtxx
```

-   Texture suffix [a]{.ceg} can only be used with Sandy textures (e.g. [Aa]{.ceg})
-   Texture suffix [x]{.ceg} can only be used where extremely stony (e.g. [Xx]{.ceg})
-   Texture suffixes [r]{.ceg} and [h]{.ceg} can only be used with Organic texture (e.g. [Oh]{.ceg})

#### Structure {#sec-in-fh-str}

```{r}
#| label: tbl-in-fhstr
#| tbl-cap: "Functional horizon - structure classes"

dat_in_fhtxx <-
  tribble(~Code, ~Name, ~Description,
         'C', 'Coarse', 'At least 50% peds of size > 40 mm, *or* apedal massive structure',
         'F', 'Fine', 'At least 50% peds of size < 40 mm, including horizons where coarse structure breaks to finer nested peds',
         'E', 'Earthy', 'Weak soil strength with very weak ped strength', 
         'K', 'Platy',  'At least 50% peds of any size, with a platy shape')

tbl_in_fhtxx <- gt(dat_in_fhtxx) |>
  tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  cols_width(Code ~pct(10), Name ~ pct(20))
  
tbl_in_fhtxx
```

-   Structure codes ([C]{.ceg}, [F]{.ceg}) can only be used with [L]{.ceg} or [Y]{.ceg} texture codes, and only where consistence is not [w]{.ceg}.
-   Structures [E]{.ceg} and [K]{.ceg} can only be used with texture [L]{.ceg}.

#### Consistence {#sec-in-fh-cons}

```{r}
#| label: tbl-in-fhcon
#| tbl-cap: "Functional horizon - consistence classes"

dat_in_fhcon <-
  tribble(~Code, ~Name, ~Description,
         'w', 'weak', 'Fails under gentle force (strength class 1--2)',
         'ws', 'weak + slightly firm', 'Contains a mix of weak and slightly firm peds',
         's', 'slightly firm', 'Fails under moderate force (strength class 3)', 
         'f', 'firm',  'Fails under strong force (strength class 4+)',
         'l', 'loose', 'Easily dislodged by spade or pick; does not maintain a vertical face, > 35% stone and/or sandy',
         'c', 'compact', 'Intermediate between loose and dense, > 35% stone',
         'd', 'dense', 'Difficult to dislodge except with spade and by removing individual fragments; maintains a stable vertical face, > 35% stone' )

tbl_in_fhcon <- gt(dat_in_fhcon) |>
  tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  fmt_markdown(columns = 3) |>
  cols_width(Code ~pct(10), Name ~ pct(20))
  
tbl_in_fhcon
```

-   Consistence [ws]{.ceg} can only be used with texture [Y]{.ceg}.
-   Consistence [w]{.ceg}, [ws]{.ceg}, [s]{.ceg}, and [f]{.ceg} can only be used with non-stony or stony ([S]{.ceg}) codes. [V]{.ceg} and [X]{.ceg} codes use consistence [l]{.ceg}, [c]{.ceg}, or [d]{.ceg} instead.

#### Permeability {#sec-fh-perm}

The permeability class represents saturated hydraulic conductivity (*K*~sat~) measured as the rate of water infiltrating into a soil horizon when water is ponded at 10 mm deep at the top of the horizon. Assign one of the classes in @tbl-in-hznperm to each horizon. Note that ['xs']{.ceg} represents effective impermeability. The classes have been slightly simplified from those in Griffiths [-@griffiths1991] and Griffiths et al [-@griffiths1999].

Permeability is very difficult to assess in the field, but considerable work has been done to associate particular ranges of values with the components of the functional horizon. As such, each functional horizon has a default permeability class and usually one or more additional allowable classes. Use the functional horizon name to narrow down the appropriate choice of permeability rating, per @tbl-in-fh below.

```{r}
#| label: tbl-in-hznperm
#| tbl-cap: "Horizon-level permeability classes"

# consider adding common horizon types?

dat_in_hznperm <-
  tribble(~Code, ~Name, ~Description,
          'xs', 'Extremely slow', '< 0.1 mm/h',
          's', 'Slow', '0.1 - 4 mm/h',
          'ms', 'Moderately slow', '4 - 18 mm/h',
          'm', 'Moderate', '18 - 72 mm/h',
          'r', 'Rapid', '> 72 mm/h')

tbl_in_hznperm <- gt(dat_in_hznperm) |>
   tab_options(
    column_labels.font.weight = 'bold', 
    heading.title.font.weight = 'bold',
    table.align = 'center',
    table.width = '85%'
  ) |>
  tab_style(style = list(cell_text(color  = 'red', 
                                   weight = 'bold',
                                   align  = 'center')),
            locations = cells_body(columns = 1)) |>
  cols_width(Code ~pct(10), Name ~pct(30))


tbl_in_hznperm

```

### Functional horizon names {#sec-fh-name}

Valid combinations of the above components are listed below, along with associated permeability classes.

-   The [t]{.ceg} prefix can be added to any of these.
-   The [z]{.ceg} *or* [b]{.ceg} prefix can be added to any of these, except for [Oh]{.ceg}, [Or]{.ceg}, [J]{.ceg}, and [Q]{.ceg}.
-   A good reason is needed to deviate from the default permeability (e.g. an [Lw]{.ceg} with [r]{.ceg} permeability would need a low clay content).

| Code | Name | Allowed permeabilities | Topsoil allowed permeabilities |
|:--:|:---|:---|:---|
| [J]{.ceg} | Fluid | **xs** | **xs** |
| [Or]{.ceg} | Fibric organic | r **m** | **r** m |
| [Oh]{.ceg} | Humic organic | **m** ms s | **m** ms |
| [OhA]{.ceg} | Sandy humic organic | m **ms** | **m** ms |
| [OhL]{.ceg} | Loamy humic organic | **ms** s | m **ms** |
| [OhY]{.ceg} | Clayey humic organic | **s** | m **ms** s |
| [Q]{.ceg} | Indurated pan (massive, hard) | **xs** | **xs** |
| [P]{.ceg} | Placic horizon (non-indurated pan) | ms, **s** | **s** |
| [Xx]{.ceg} | Extremely stony fragmental | **r** | **r** |
| [XA]{.ceg} | Extremely stony sandy | **r** | **r** |
| [XL]{.ceg} | Extremely stony loamy | r **m** | **r** m |
| [XY]{.ceg} | Extremely stony clayey | **s** | m **ms** s |
| [VAl]{.ceg} | Very stony sandy loose | **r** | **r** |
| [VAc]{.ceg} | Very stony sandy compact | **m** ms | r **m** |
| [VAd]{.ceg} | Very stony sandy dense | **s** | ms **s** |
| [SAl]{.ceg} | Stony sandy loose | **r** | **r** |
| [SAw]{.ceg} | Stony sandy weak | **r** | **r** |
| [SAs]{.ceg} | Stony sandy slightly firm | **m** r | **r** |
| [SAf]{.ceg} | Stony sandy firm | m **ms** s | **m** ms |
| [Aa]{.ceg} | Sandy loose (dune sand) | **r** | **r** |
| [Al]{.ceg} | Sandy loose | **r** | **r** |
| [Aw]{.ceg} | Sandy weak | **r** | **r** |
| [As]{.ceg} | Sandy slightly firm | **m** r | **r** |
| [Af]{.ceg} | Sandy firm | m **ms** | **m** ms |
| [VLl]{.ceg} | Very stony loamy loose | r **m** | **r** m |
| [VLc]{.ceg} | Very stony loamy compact | m **ms** s | **m** ms |
| [VLd]{.ceg} | Very stony loamy dense | **s** xs | **s** |
| [SLw]{.ceg} | Stony loamy weak | **m** r | m **r** |
| [SLFs]{.ceg} | Stony loamy fine, slightly firm | **m** ms | **m** ms |
| [SLFf]{.ceg} | Stony loamy fine, firm | **ms** s | **m** ms |
| [SLCs]{.ceg} | Stony loamy coarse, slightly firm | m **ms** s | m **ms** |
| [SLCf]{.ceg} | Stony loamy coarse, firm | **s** xs | **ms** s |
| [LEw]{.ceg} | Loamy earthy weak | r **m** | **r** m |
| [Lw]{.ceg} | Loamy week | r **m** | **r** m |
| [LFs]{.ceg} | Loamy fine slightly firm | m **ms** | **m** ms |
| [LFf]{.ceg} | Loamy fine firm | **ms** s | **m** ms |
| [LCs]{.ceg} | Loamy coarse slightly firm | m **ms** s | m **ms** |
| [LCf]{.ceg} | Loamy coarse firm | **s** xs | **ms** s |
| [LK]{.ceg} | Loamy platy (\> weak) | **s** | ms **s** |
| [VYl]{.ceg} | Very stony clayey loose | r **m** ms | **r** m |
| [VYc]{.ceg} | Very stony clayey compact | ms **s** | m **ms** |
| [VYd]{.ceg} | Very stony clayey dense | **s** xs | **s** |
| [SYw]{.ceg} | Stony clayey fine weak | r **m** | **r** m |
| [SYFs]{.ceg} | Stony clayey fine slightly firm | m **ms** | r **m** ms |
| [SYFws]{.ceg} | Stony clayey fine weak + slightly firm | r m **ms** | r **m** ms |
| [SYFf]{.ceg} | Stony clayey fine firm | **ms** s | **m** ms |
| [SYC]{.ceg} | Stony clayey coarse | **s** | **ms** s |
| [Yw]{.ceg} | Clayey weak | r **m** | **r** m |
| [YFs]{.ceg} | Clayey fine slightly firm | m **ms** | r **m** ms |
| [YFws]{.ceg} | Clayey fine weak + slightly firm | r m **ms** | r **m** ms |
| [YFf]{.ceg} | Clayey fine firm | **ms** s | **m** ms |
| [YC]{.ceg} | Clayey coarse firm | **s** | m **ms** s |

: Functional horizon names and allowed permeability classes. Default permeabilities are bolded {#tbl-in-fh .striped .hover tbl-colwidths=\[10,50,20,20\]}
